CODE SEGMENT
ASSUME CS:CODE , DS:CODE ,SS:CODE ,ES:CODE
   PA     EQU 00H
   PB     EQU 04H
   PC     EQU 0AH
   CO     EQU 0EH

ORG 0000H

   MOV AL , 10010000B ;CONTROL WPRD: MAKE PORTA INPUT AND PORT B,C OUTPUT
   OUT CO , AL
   MOV AL , 10000000B ;SET WR WITH 1 HIGH PC7
   OUT PC , AL
   LEA SI , TABLE ;LOAD THE NUMBER


START:
      IN AL , PC  ;TO CHANGE PC7 ONLY
      AND AL , 7FH ;CLEAR OR MAKE PC7=0 [WR]
      OUT PC , AL
      CALL DELAY

      OR AL ,10000000B ;SET PC7=1 [WR]
      OUT PC,AL
      CALL DELAY    ; wait for conversion complete

      IN AL , PA ;GET A/D OUTPUT

      MOV AH , 00H   ;START CALCULATION
      MOV BX , 196D  ; EACH A/D STEP = 5/255 = 19.6 MV
      MUL BX
      MOV BX , 100D ; temperatyre = (NUM*196) / 100
      DIV BX         ; QUOTIENT IN AX - REMINDER IN DX

;CALCULATE QUOTIENT (THE LEFT NUMBER)

   MOV BX , AX
   MOV AL , [BX+SI] ; TO KNOW THE NUMBER IN TABLE
   OR  AL , 80H     ;TO INCLUDE DECIMAL POINT
   OUT PB , AL

;CALCULATE REMINDER (THER RIGHT NUMBER)

   MOV AX , DX
   MOV DX , 0D
   MOV BX , 10D
   DIV BX

   MOV BX , AX
   MOV AL , [BX+SI]  ; TO KNOW THE NUMBER IN TABLE
   OR  AL , 80H   ; keep wr in active
   OUT PC , AL

JMP START


DELAY:
MOV CX , 5882D   ;delay for 0.1 seconed
L1:  LOOP L1
RET

TABLE:
   DB 3FH
   DB 06H
   DB 5BH
   DB 4FH
   DB 66H
   DB 6DH
   DB 7DH
   DB 07H
   DB 7FH
   DB 6FH ;9

CODE ENDS
END

